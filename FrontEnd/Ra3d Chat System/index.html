<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Ra3d</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- TITLE BAR -->
  <div class="titlebar">
    <div class="title">Secure Platform</div>
    <div class="controls">
      <div class="btn min" onclick="win.min()"></div>
      <div class="btn max" onclick="win.max()"></div>
      <div class="btn close" onclick="win.close()"></div>
    </div>
  </div>

  <!-- ROOT VIEW CONTAINER -->
  <div class="root">

    <!-- ================= AUTH VIEW ================= -->
    <div class="app view-layer active" id="authView">

      <div class="left">
        <h1>Secure Platform</h1>
        <p>Control. Power. Access.</p>
      </div>

      <div class="right">
        <div class="card">

          <!-- LOGIN -->
          <div class="view active" id="loginView">
            <h2>Login</h2>

            <input type="text" placeholder="Username">
            <input type="password" placeholder="Password">

            <button class="primary" onclick="doLogin()">Login</button>

            <p class="switch">
              Donâ€™t have an account?
              <span onclick="switchView('register')">Register</span>
            </p>
          </div>

          <!-- REGISTER -->
          <div class="view" id="registerView">
            <h2>Register</h2>

            <input type="text" placeholder="Username">
            <input type="password" placeholder="Password">
            <input type="password" placeholder="Confirm Password">

            <button class="primary" onclick="doRegister()">Create Account</button>

            <p class="switch">
              Already have an account?
              <span onclick="switchView('login')">Login</span>
            </p>
          </div>

        </div>
      </div>

    </div>

    <!-- ================= CHAT VIEW ================= -->
    <div class="chat-app view-layer" id="chatApp">

      <!-- SERVERS -->
      <div class="servers">
        <div class="server active">ğŸ’¬</div>
        <button class="logout-btn-server" onclick="doLogout()" title="Logout">ğŸšª</button>
      </div>

      <!-- CHANNELS -->
      <div class="channels">
        <div class="channel-header">
          <h3>Ra3d</h3>
          <span>ğŸ”’ E2EE</span>
        </div>

        <div class="user-profile">
          <span class="profile-greeting">Hi, <span id="currentUsername">User</span></span>
        </div>

        <div class="rooms-header">
          <h4>Rooms</h4>
          <button class="add-room-btn" onclick="showCreateRoomDialog()">+</button>
        </div>
        <div id="roomsList" class="rooms-list">
          <!-- Rooms will be dynamically added here -->
        </div>

        <div class="rooms-header archived-header">
          <h4>ğŸ“¦ Archived</h4>
        </div>
        <div id="archivedRoomsList" class="rooms-list archived-list">
          <!-- Archived rooms will be dynamically added here -->
        </div>
      </div>

      <!-- CHAT -->
      <div class="chat">
        <div class="chat-header">
          <h4># general</h4>
          <div class="header-actions">
            <button id="groupInfoBtn" class="info-btn" onclick="showGroupInfo()" style="display: none;" title="Group Info">â„¹ï¸</button>
            <button id="addMembersBtn" class="add-members-btn" onclick="showAddMembersDialog()" style="display: none;">+ Add Members</button>
            <button id="leaveGroupBtn" class="leave-btn" onclick="leaveCurrentGroup()" style="display: none;">Leave Group</button>
            <span class="encryption-badge">ğŸ” End-to-End Encrypted</span>
          </div>
        </div>

        <div class="messages" id="messages">
          <!-- Messages will be dynamically added here -->
          <div class="welcome-message">
            <p>ğŸ”’ End-to-end encrypted chat</p>
            <p>Your messages are secure</p>
          </div>
        </div>

        <div class="input-bar">
          <input id="messageInput" placeholder="Type a message..." />
          <button onclick="sendMessage()">â¤</button>
        </div>
      </div>

    </div>

  </div>
  <div id="toast" class="toast"></div>
  
  <!-- Create Room Dialog -->
  <div id="createRoomDialog" class="dialog-overlay">
    <div class="dialog">
      <h3>Create Room</h3>
      <div class="tabs">
        <button class="tab active" onclick="switchRoomTab('dm')">Direct Message</button>
        <button class="tab" onclick="switchRoomTab('group')">Group Room</button>
      </div>
      
      <div id="dmTab" class="tab-content active">
        <input type="text" id="dmUsername" placeholder="Enter username" />
        <div class="dialog-buttons">
          <button class="secondary" onclick="hideCreateRoomDialog()">Cancel</button>
          <button class="primary" onclick="createDMRoom()">Create DM</button>
        </div>
      </div>
      
      <div id="groupTab" class="tab-content">
        <input type="text" id="groupRoomName" placeholder="Room name" />
        <textarea id="groupUsernames" placeholder="Enter usernames (one per line)" rows="5"></textarea>
        <div class="dialog-buttons">
          <button class="secondary" onclick="hideCreateRoomDialog()">Cancel</button>
          <button class="primary" onclick="createGroupRoom()">Create Group</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ================= GROUP INFO DIALOG ================= -->
  <div id="groupInfoDialog" class="dialog-overlay" style="display: none;">
    <div class="dialog-box info-dialog">
      <h3 id="groupInfoName">Group Name</h3>
      <div class="info-section">
        <label>Group ID:</label>
        <span id="groupInfoId" class="info-value"></span>
      </div>
      <div class="info-section">
        <label>Created By:</label>
        <span id="groupInfoCreator" class="info-value"></span>
      </div>
      <div class="info-section">
        <label>Created At:</label>
        <span id="groupInfoCreatedAt" class="info-value"></span>
      </div>
      <div class="info-section">
        <label>Members (<span id="groupInfoMemberCount">0</span>):</label>
        <ul id="groupInfoMembers" class="members-list">
          <!-- Members will be populated dynamically -->
        </ul>
      </div>
      <div class="dialog-actions">
        <button onclick="closeGroupInfo()" class="btn-primary">Close</button>
      </div>
    </div>
  </div>
  
  <!-- ================= ADD MEMBERS DIALOG ================= -->
  <div id="addMembersDialog" class="dialog-overlay" style="display: none;">
    <div class="dialog-box">
      <h3>Add Members to Group</h3>
      <p>Enter usernames to add (comma-separated):</p>
      <input id="addMembersInput" type="text" placeholder="user1, user2, user3" />
      <div class="dialog-actions">
        <button onclick="confirmAddMembers()" class="btn-primary">Add</button>
        <button onclick="closeAddMembersDialog()" class="btn-secondary">Cancel</button>
      </div>
    </div>
  </div>

  <!-- ================= TRANSFER ADMIN DIALOG ================= -->
  <div id="transferAdminDialog" class="dialog-overlay" style="display: none;">
    <div class="dialog-box">
      <h3>Transfer Admin Before Leaving</h3>
      <p>You are the group creator. Select a new admin:</p>
      <select id="newAdminSelect" class="admin-select">
        <!-- Options will be populated dynamically -->
      </select>
      <div class="dialog-actions">
        <button onclick="confirmTransferAndLeave()" class="btn-primary">Transfer & Leave</button>
        <button onclick="closeTransferAdminDialog()" class="btn-secondary">Cancel</button>
      </div>
    </div>
  </div>
  
  <script src="renderer.js"></script>
</body>
</html>
